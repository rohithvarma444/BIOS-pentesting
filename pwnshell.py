#!/usr/bin/python3
import base64
from pwn import *
import codecs

def base64_decode(s):
    # Decode the bytes using base64
    decoded_b = base64.b64decode(s) 
    return decoded_b

def rot13_decode(b):
    # Convert the bytes to a string using the 'utf-8' encoding
    s = b.decode('utf-8')
    # Apply the rot13 cipher
    decoded_s = codecs.encode(s,'rot13')
    # Convert the decoded string back to bytes
    decoded_b = decoded_s.encode('utf-8')
    return decoded_b

connect=remote('3.110.229.92','30063')

connect.recvline()
l1 = connect.recvline()
w1 = l1.split()
print(w1)
if w1[2]==b'rot_13':
	connect.sendline(rot13_decode(w1[5]))
elif w1[2]==b'base64':
	connect.sendline(base64_decode(w1[5]))
connect.recvline()
connect.sendline(b'HAPPY PRIDE')
connect.recvline()
connect.recvline()
connect.recvline()
print(connect.recvline())
connect.sendline(b'R5A_c4n_b3_3xpl0it3d')
connect.recvline()
connect.recvline()
connect.recvline()
connect.recvline()
connect.recvline()
connect.recvline()
connect.recvline()
print(connect.recvline())



connect.close()
